# 기능 정의서

프로젝트 정의서의 사용자 스토리를 기반으로 세부 기능을 구체적으로 정의합니다.

### **🖥️ 페이지**

1. **사장님**
   - 소셜 로그인/회원가입 페이지
     - 소셜 로그인 (카카오) 버튼
   - 사업장 등록 버튼
   - 주문서 제작(생성) 페이지
     - 커스텀
       - 텍스트, 체크박스, 라디오 버튼, 이미지 등 자유롭게 제작
       - 보관법/가격/재고 안내 등 추가 기입
   - (사장님만 해당) 마이페이지
     - 사업장 정보 수정 버튼
       - 사업자 등록 번호 수정
       - 인증 절차
     - 내가 등록한 업종 정보(가게명, 주소, 연락처 등) 수정/삭제 버튼
   - 메인 페이지
     - 링크
     - 내가 생성한 나의 주문서(폼)
     - 예약 현황
       - 대기/확정
   - 예약 페이지
     - (기본) 리스트
       - 필터링 (대기/확정)
       - 개별 주문서 확인 가능
     - (추가 버튼) 달력
2. **소비자(고객)**
   1. 전체 업종 탐색 페이지
      1. 필터링 기능 (지역, 업종)
      2. 검색 기능 (업장명)
   2. 주문서 작성
      1. [필수] 이름, 연락처 기입
      2. [필수] 예약금 입금
   3. 주문에 대한 대기/확정 알림
      1. 취소/환불에 관한 안내사항 함께
      2. 주문서 상세보기를 통해 입력한 주문서, 주문 현황 등 확인 가능
   4. 주문에 대한 취소 알림

---

### 전체 업종 탐색 사용자 스토리

---

```mermaid
%% 전체 업종 탐색
flowchart LR
A(업종 탐색 페이지 접속) --> B(지역 필터 선택)
A(업종 탐색 페이지 접속) --> C(업종 필터 선택)
B(지역 필터 선택) --> D{지역 필터링 결과 표시}
C(업종 필터 선택) --> E{업종 필터링 결과 표시}
D{지역 필터링 결과 표시} --> F(결과 업종 목록 표시)
E{업종 필터링 결과 표시} --> F(결과 업종 목록 표시)

```

```mermaid
%% 주문서 작성
flowchart LR
A(업종 탐색 페이지 접속) --> B(업장명 검색창)
B --> C{업장명 검색 결과 표시}
C --> D(검색된 업장명 리스트 표시)

```

**기능**

1. **필터링 기능 (지역, 업종)**
   - `고객`은 지역(예: 서울, 경기)과 업종(예: 케이크, 꽃)을 선택하여 조건에 맞는 원하는 업종을 탐색할 수 있다.
   - `고객`은 평점순/거리순에 따라 업종을 탐색할 수 있다.
   - `고객`이 필터를 설정하지 않으면 기본 정렬 조건(평점 순, 거리 순 등)에 따라 자동으로 결과가 표시된다.
2. **검색 기능 (업장명)**
   - `고객`은 특정 업장명을 입력하여 해당 업장을 빠르게 검색할 수 있다.

**입력 항목**

1. **필터**
   - 지역: 드롭다운 선택 (최대 1개 선택 가능)
   - 업종: 드롭다운 선택 (최대 1개 선택 가능)
2. **검색**
   - 업장명: 문자열 입력 (최대 30자)

**사용자 액션**

1. **필터링 버튼 클릭**
   - `고객`이 지역 및 업종 선택 후, 필터링 API 호출.
   - API 호출 성공 시 필터링된 업장 목록 표시.
2. **검색 버튼 클릭**
   - 업장명 입력 후 검색 API 호출.
     - API 호출 성공 시, 업장 목록에서 해당 업장만 표시.
     - API 호출 실패 시, 오류 메시지(예: 검색 결과가 없습니다.) 제공.

### 주문서 작성 사용자 스토리

---

```mermaid
flowchart LR
A(주문서 작성 페이지 접속) --> B(이름 입력)
A --> C(연락처 입력)
A --> F(커스텀 주문 항목 선택 및 입력)
B --> D{입력 완료 확인}
C --> D
F --> D
D --> E(입력 완료 후 예약금 입금 단계로 진행)

```

```mermaid
flowchart LR
A(예약금 입금 단계) --> B(예약금 입금 안내)
B --> C(입금 여부 확인)
C --> |입금 완료| D(주문서 제출 단계로 이동)
C --> |입금 미완료| E(입금 미완료 메시지 표시)

```

**기능**

1. **사용자 정보 입력과 주문 항목 커스터마이징**
   - `고객`은 이름, 연락처와 함께 주문 항목에 대한 맞춤 정보를 기입할 수 있다.
   - 주문 항목
     - 픽업 날짜 및 시간 선택
     - 요청 사항 입력(텍스트)
     - 옵션 선택(체크박스/라디오버튼/드롭다운 등)
2. **유효성 검사**
   - 주문 항목에 대한 유효성 검사
     - 날짜 형식 확인(YYYY-MM-DD)
     - 요청 사항 글자 수 제한(최대 500자)
     - 옵션이 반드시 선택되어야 하는 경우 확인

**입력 항목**

1. 이름: 문자열 (최대 50자)
2. 연락처: 문자열 (숫자 형식, 최대 15자)
3. 픽업 날짜: 문자열 (YYYY-MM-DD)
   - 요청 사항: 텍스트(최대 500자)
4. 추가 옵션

    - 텍스트/라디오 버튼/체크박스/드롭다운/이미지 삽입 등의 형태.

1. 결제 수단 선택: 라디오 버튼 형태로 제공.
2. 입금 확인 버튼: 결제 완료 후 `고객`이 클릭하여 프로세스 종료.

**사용자 액션**

1. **이름 및 연락처 기입**
   - `고객`은 이름과 연락처 입력하고 확인 버튼 클릭
     - 유효성 검사 통과 시 다음 단계 진행, 실패 시 오류 메시지 표시.
2. **커스텀 주문 항목 입력**
   - 픽업 날짜: 달력 위젯 또는 텍스트 입력
   - 요청 사항: 텍스트 입력 창 제공.
   - 옵션 선택: 텍스트/라디오 버튼/체크박스/드롭다운/이미지 삽입 등의 형태
   - 유효성 검사 실패 시 오류 메시지 제공.
3. **예약금 입금**
   - **결제 수단 선택**
     - `고객`이 무통장, 네이버페이, 토스페이 중 하나를 선택.
     - 선택된 결제 수단에 따라 해당 결제 프로세스 진행
       - **무통장:** 입금 계좌 정보 제공.
       - **네이버페이, 토스페이:** 해당 결제 창으로 리다이렉트 또는 팝업 실행
   - **결제 완료 후 확인**
     - 결제가 완료되면 "입금 확인" 버튼 클릭
     - 예약금 확인 API 호출.
   - **API 결과 처리**
     - API 호출 성공 시, 주문서 제출 API 호출 후 완료(예: 주문이 성공적으로 제출되었습니다.) 메시지 표시
     - API 호출 실패 시, 결제 실패 메시지(예: 입금 확인이 이루어지지 않았습니다.) 제공

### 주문에 대한 대기/확정 알림 사용자 스토리

---

```mermaid
flowchart LR
A(카카오톡 알림 발송) --> B{주문 상태 확인}
B --> |대기| C(대기 알림 발송)
C --> D(대기 상태 유지 중)
D --> |확정 전환| E(확정 알림 발송)
E --> F(추가 정보 제공 및 주문 상세보기 버튼 포함)

```

```mermaid
flowchart LR 
A(주문서 상세보기 페이지 접속) --> B(입력한 주문서 정보 확인)
A --> C(주문 현황 확인)
B --> D(입력한 주문서 내용 표시)
C --> E(주문 상태 및 변경 사항 표시)

```

**기능**

1. **주문 상태 실시간 확인**
   - `고객`은 카카오톡 알림 메시지를 통해 주문 상태(예: 대기, 확정 등)를 확인할 수 있다.
   - 주문 번호와 상태, 상세 정보를 알림 메시지에서 바로 확인 가능하다.
2. **알림 메시지 내 버튼 링크 제공**
   - "주문 상세보기" 버튼 클릭 시, `고객`은 별도의 입력 없이 주문 상세 페이지로 연결된다.

3 . **상태 변경 안내**

- 대기 상태에서 확정 상태로 변경될 경우, `고객`에게 카카오톡 알림 메시지로 안내한다.

**사용자 액션**

1. **대기 상태 알림 수신**
   - 주문이 대기 상태일 경우, 서버는 해당 `고객`의 휴대폰 번호로 카카오톡 알림 메시지를 전송.
   - 알림 메시지에는 아래 정보 포함:
     - 주문 번호
     - 주문 요약
     - 현재 상태: "대기 중"
     - "주문 상세보기" 버튼
2. **확정 상태 알림 수신**
   - 대기 상태에서 확정 상태로 전환 시, 서버에서 카카오톡 알림 메시지를 추가로 발송.
   - 알림 메시지에는 아래 정보 포함:
     - 주문 번호
     - 주문 요약
     - 현재 상태: "확정"
     - 확정 후 진행 상황에 대한 추가 정보
     - "주문 상세보기" 버튼
3. **주문 상세 페이지 확인**
   - `고객`이 카카오톡 알림의 "주문 상세보기" 버튼을 클릭.
   - 주문 상세 페이지에서 입력된 주문 정보와 대기 → 확정 상태 변경 내역을 확인.

### 주문에 대한 취소 알림 사용자 스토리

---

```mermaid
flowchart LR
A(카카오톡 알림 발송) --> B{주문 상태 확인}
B --> |취소| C(취소 알림 발송)
C --> D(취소 사유 및 환불 정책 안내 포함)

```

```mermaid
flowchart LR
A(주문서 상세보기 페이지 접속) --> B(취소된 주문 정보 확인)
B --> C(취소 사유 표시)
C --> D(환불 상태 및 예상 소요 기간 표시)

```

**기능**

1. **주문 취소 상태 알림**
   - `고객`은 주문이 취소된 경우, 카카오톡 알림 메시지를 통해 주문 상태를 확인할 수 있다.
   - 알림 메시지에는 주문 번호, 취소 사유, 환불 정책 등이 포함된다.
2. **알림 메시지 내 버튼 링크 제공**
   - "주문 상세보기" 버튼 클릭 시, `고객`은 취소된 주문의 상세 정보를 확인할 수 있는 페이지로 연결된다.

**사용자 액션**

1. **카카오톡 알림 수신**
   - 주문이 취소되면 서버에서 해당 사용자의 휴대폰 번호를 통해 카카오톡 알림 메시지 전송.
   - 알림 메시지에는 아래 정보 포함:
     - 주문 번호
     - 취소 사유
     - 환불 정책 안내
     - "주문 상세보기" 버튼
2. **주문 상세 페이지 확인**
   - `고객`이 알림에서 "주문 상세보기" 버튼을 클릭.
   - 취소된 주문 번호, 취소 사유, 환불 상태(환불 예정 금액, 소요 기간 등)가 표시된 주문 상세 페이지로 연결.
